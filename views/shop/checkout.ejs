<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/assets/favicon.png"
    />
    <link rel="stylesheet" href="/style/main.css" />
    <link rel="stylesheet" href="/style/cart.css" />
    <title><%= pageTitle %></title>
  </head>
  <body>
    <%- include('../layouts/header.ejs') %>
    <main>
      <ul class="cart__item-list">
        <% products.forEach(p=> { %>
        <li class="cart-item">
          <h1><%=p.productId.title %></h1>
          <h4>數量 : ( <%=p.quantity %> )</h2>
        </li>
        <% }) %>
      </ul>
      <div class="order">
        <h2>Total: <%= totalSum  %> </h2>
      </div>
      <div class="order">
        <button id="order-btn" class="btn">確認結帳</button>
        <script src="https://js.stripe.com/v3/"></script>
        <script>
          var stripe = Stripe('pk_test_51KKclgHqSB5YLMN0uJLWwqTYwz2QLT3jkIAiqqjyetjGW9tYgBRPpV7F7379VWEi65Wn1iLlKJwKQYeTRRbgdA1300HjJ6Gpfk')
          var orderBtn = document.getElementById('order-btn')
          orderBtn.addEventListener('click', function(){
            stripe.redirectToCheckout({
              sessionId: '<%=sessionId%>',
            })
          })
        </script>
        <script src="/js/main.js"></script>
      </div>
    </main>
  </body>
</html>
